---
title: "FinFlexMacro"
output: 
  flexdashboard::flex_dashboard:
    orientation: columns
    vertical_layout: fill
---

```{r setup, include=FALSE}
library(flexdashboard)
library(plotly)
library(jsonlite)
```

```{r data-create, echo = F}
## create fake data to test idea
days <- c(rep(1, 5), rep(2, 5), rep(3, 5),
          rep(4, 5))
xs <- rep(c("1 month", "2 month", "3 month", "6 month", "1 year"), times = 4)
vals <- rnorm(20, 0, 1)
datVis <- data.frame(days = days, x = xs, y = vals)
```

```{r, echo = F, results = 'asis'}
cat('<script src="https://cdn.plot.ly/plotly-latest.min.js"></script>')
cat('<script src="selectize.js"></script>')
cat(
  paste(
  '<script>
    var data = ',toJSON(datVis),';
  </script>'
  , sep="")
)
```


Column {data-width=650}
-----------------------------------------------------------------------

### Chart A

```{r, echo = FALSE, results = 'asis'}
myDiv <- cat('<div id = "widget-area" style = "display:flex;"><div id = "myDiv" style="width:80%; height:400px;"></div>')
options <- paste("<option value ='", unique(days), "'>", unique(days), "</option>", sep = "")
cat("<div style = 'text-align:center'><h5>Select the day(s):</h5>")
cat(paste("<select id = 'select-day' style = 'align:center;'>", paste(options, collapse = ""),
          "</select>"))
cat('</div></div>')
## make the plot change when the select changes:
cat(paste("<script>
$('#select-day').selectize({maxItems:3});
$('#select-day-selectized').css('min-width', '60px');
$('#select-day').on('change', function() {
  var subDatX = [];
  var subDatY = [];
  var currVal = $('#select-day').val();
  console.log(currVal);
  var traces = [];
  for (var i = 0; i < currVal.length; i++)
  {
    for (var j = 0; j < data.length; j++)
    {
      if (data[j].days == currVal[i])
      {
        subDatX.push(data[j].x);
        subDatY.push(data[j].y);
      }
    }
    temp = {};
    temp.x = subDatX;
    temp.y = subDatY;
    temp.type = 'scatter';
    temp.name = 'day ' + currVal[i];
    traces.push(temp);
    subDatX = [];
    subDatY = [];
  }
  console.log(traces);
  // Create the plotly plot
  var plotDat = traces;
  Plotly.newPlot('myDiv', plotDat);
});</script>"))

```


Column {data-width=350}
-----------------------------------------------------------------------

### Chart B

```{r}

```

### Chart C

```{r}

```

